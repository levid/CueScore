// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty;

CueScore.API = (function() {

  function API(login, password) {
    this.login = login;
    this.password = password;
  }

  API.prototype.requestURI = function(path, query) {
    var key, uri, value;
    if (query == null) {
      query = {};
    }
    CueScore.API_ENDPOINT = "http://hello_ti.com/api";
    uri = "" + CueScore.API_ENDPOINT + path + ".json?";
    for (key in query) {
      if (!__hasProp.call(query, key)) continue;
      value = query[key];
      uri += "" + key + "=" + (escape(value)) + "&";
    }
    return uri;
  };

  API.prototype.request = function(path, options, authenticated) {
    var data, message, uri, xhr, _ref, _ref1, _ref2, _ref3;
    if (authenticated == null) {
      authenticated = true;
    }
    if ((_ref = options.method) == null) {
      options.method = 'GET';
    }
    if ((_ref1 = options.query) == null) {
      options.query = {};
    }
    if ((_ref2 = options.success) == null) {
      options.success = function() {
        return Ti.API.info;
      };
    }
    if ((_ref3 = options.error) == null) {
      options.error = function() {
        return Ti.API.error;
      };
    }
    xhr = Ti.Network.createHTTPClient();
    xhr.onreadystatechange = function(e) {
      var data;
      if (this.readyState === 4) {
        try {
          data = JSON.parse(this.responseText);
          if (data.error != null) {
            return options.error(data);
          } else {
            return options.success(data);
          }
        } catch (exception) {
          return options.error(exception);
        }
      }
    };
    uri = this.requestURI(path, options.query);
    xhr.open(options.method, uri);
    if (authenticated) {
      xhr.setRequestHeader('Authorization', 'Basic ' + Ti.Utils.base64encode(this.login + ':' + this.password));
    }
    message = "Executing ";
    message += authenticated ? "Authenticated " : "Unauthenticated ";
    message += "" + options.method + " " + uri;
    if (options.debug) {
      Ti.API.debug(message);
    }
    if (options.body != null) {
      xhr.setRequestHeader('Accept', 'application/json');
      xhr.setRequestHeader('Content-Type', 'application/json');
      data = JSON.stringify(options.body);
      if (options.debug) {
        Ti.API.debug(data);
      }
      return xhr.send(data);
    } else {
      return xhr.send();
    }
  };

  API.prototype.get = function(path, options, authenticated) {
    if (authenticated == null) {
      authenticated = true;
    }
    options.method = 'GET';
    return this.request(path, options, authenticated);
  };

  API.prototype.post = function(path, options, authenticated) {
    if (authenticated == null) {
      authenticated = true;
    }
    options.method = 'POST';
    return this.request(path, options, authenticated);
  };

  API.prototype.put = function(path, options, authenticated) {
    if (authenticated == null) {
      authenticated = true;
    }
    options.method = 'PUT';
    return this.request(path, options, authenticated);
  };

  API.prototype["delete"] = function(path, options, authenticated) {
    if (authenticated == null) {
      authenticated = true;
    }
    options.method = 'DELETE';
    return this.request(path, options, authenticated);
  };

  return API;

})();

CueScore.App = {
  initTabGroup: function() {
    var sampleWindow, settingsWindow;
    CueScore.App.tabGroup = Ti.UI.createTabGroup();
    sampleWindow = CueScore.Views.Sample.createMainWindow({
      title: 'Sample',
      id: 'sampleWindow',
      orientationModes: CueScore.Helpers.Application.createOrientiationModes
    });
    CueScore.App.sampleTab = Ti.UI.createTab({
      id: 'sampleTab',
      className: 'tabElement',
      title: 'Sample',
      window: sampleWindow
    });
    CueScore.App.tabGroup.addTab(CueScore.App.sampleTab);
    settingsWindow = CueScore.Views.Settings.createMainWindow({
      title: 'Settings',
      id: 'settingsWindow',
      orientationModes: CueScore.Helpers.Application.createOrientiationModes
    });
    CueScore.App.settingsTab = Ti.UI.createTab({
      id: 'settingsTab',
      className: 'tabElement',
      title: 'Settings',
      window: settingsWindow
    });
    CueScore.App.tabGroup.addTab(CueScore.App.settingsTab);
    CueScore.App.tabGroup.addEventListener('focus', function(e) {
      CueScore.App.currentTab = e.tab;
      return Ti.API.info(CueScore.App.currentTab);
    });
    return CueScore.App.tabGroup.open();
  }
};

CueScore.Helpers.Application = {
  createOrientiationModes: function() {
    var modes;
    modes = [Titanium.UI.PORTRAIT, Titanium.UI.UPSIDE_PORTRAIT, Titanium.UI.LANDSCAPE_LEFT, Titanium.UI.LANDSCAPE_RIGHT];
    return modes;
  }
};

CueScore.Views.Sample.createMainWindow = function(options) {
  var window;
  window = Ti.UI.createWindow(options);
  return window;
};

CueScore.Views.Settings.createMainWindow = function(options) {
  var window;
  window = Ti.UI.createWindow(options);
  return window;
};
